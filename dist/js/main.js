var DrillDownMenu=function(a){var b=new DrillDownMenuItems;this.view=new DrillDownMenuView({items:b}).render();var c=this;a.forEach(function(a){c.addMenuItem(b,a)})};DrillDownMenu.prototype.getView=function(){return this.view},DrillDownMenu.prototype.addMenuItem=function(a,b){b.hasOwnProperty("children")?this.addMenuItems(a,b):a.add(new DrillDownMenuItem({title:b.title}))},DrillDownMenu.prototype.addMenuItems=function(a,b){var c=new DrillDownMenuItems({title:b.title});a.add(c);var d=this;b.children.forEach(function(a){d.addMenuItem(c,a)})};var DrillDownMenuItem=Backbone.Model.extend({}),DrillDownMenuItemView=Backbone.View.extend({tagName:"li",template:_.template("<a><%= title %></a>"),events:{"click a":"open"},initialize:function(){this.listenTo(this.model,"add",this.addItem)},render:function(){return this.$el.html(this.template({title:this.model.attributes.title})),this.hasMenuItems()&&(this.$list=$("<ul></ul>"),this.$list.addClass("drilldown-menu"),this.$el.append(this.$list)),this},addItem:function(a){this.$list&&this.$list.append(new DrillDownMenuItemView({model:a}).render().el)},open:function(a){this.hasMenuItems()&&(a.stopPropagation(),this.$el.parent().addClass("drilldown-menu-hide"))},hasMenuItems:function(){return this.model instanceof DrillDownMenuItems}}),DrillDownMenuItems=Backbone.Model.extend({initialize:function(){this.collection=new Backbone.Collection},add:function(a){this.collection.add(a),this.trigger("add",a)}}),DrillDownMenuView=Backbone.View.extend({className:"drilldown drilldown-hide",template:_.template('<button class="drilldown-menu-return btn btn-default"><span class="glyphicon glyphicon-backward"></span></button><button class="drilldown-menu-close btn btn-default"><span class="glyphicon glyphicon-remove"></span></button><ul class="drilldown-menu" />'),events:{"click .drilldown-menu-return":"return","click .drilldown-menu-close":"close"},initialize:function(a){this.itemViews=[],this.listenTo(a.items,"add",this.addOne)},render:function(){return this.$el.html(this.template()),this},addOne:function(a){var b=new DrillDownMenuItemView({model:a});this.itemViews.push(b),this.getList().append(b.render().el)},getList:function(){return this.$("> ul")},getItemView:function(a){return this.itemViews[a]},getReturnBtn:function(){return this.$(".drilldown-menu-return")},getCloseBtn:function(){return this.$(".drilldown-menu-close")},"return":function(){this.$(".drilldown-menu-hide").removeClass("drilldown-menu-hide")},close:function(){this.$el.addClass("drilldown-hide")},open:function(){console.log(this.el),this.$el.removeClass("drilldown-hide")}});+function(a){a.fn.drilldown=function(){var a=new DrillDownMenu([]);this.menuView=a.getView();var b=this;return this.click(function(){b.menuView.open()}),this.menuView.$el}}(jQuery);